# Abbacchio API Configuration
# Copy this file to .env and adjust values as needed

# Server
PORT=4000
NODE_ENV=development

# CORS (use comma-separated origins for multiple, or * for all)
# SECURITY: In production, specify exact origin(s) - don't use *
# Default in production (without CORS_ORIGIN): http://localhost:4001
CORS_ORIGIN=*

# Authentication
# SECURITY: Required in production (NODE_ENV=production)
# Generate a secure key: openssl rand -base64 32
API_KEY=

# Proxy Trust
# SECURITY: Only set to 'true' if behind a trusted reverse proxy (nginx, Cloudflare, etc.)
# When false, x-forwarded-for and x-real-ip headers are ignored for security
TRUST_PROXY=false

# Connection Limits
MAX_CONNECTIONS=1000              # Maximum concurrent SSE connections
MAX_CONNECTIONS_PER_IP=10         # SECURITY: Max connections per IP address (DoS protection)
CONNECTION_TIMEOUT=3600000        # Connection timeout in ms (1 hour)

# Rate Limiting
ENABLE_RATE_LIMIT=true            # Set to 'false' to disable
RATE_LIMIT_WINDOW=60000           # Time window in ms (60 seconds)
RATE_LIMIT_MAX=1000               # Max requests per window per IP

# Payload Validation
MAX_PAYLOAD_SIZE=1048576          # Max payload size in bytes (1MB)
MAX_BATCH_SIZE=1000               # Max logs per batch request
MAX_SINGLE_LOG_SIZE=65536         # Max size per log entry in bytes (64KB)

# Channel Management
MAX_CHANNELS=10000                # Max registered channels
CHANNEL_TTL=86400000              # Channel expiry after inactivity in ms (24 hours)

# Backpressure
MAX_QUEUE_SIZE=1000               # Max queued messages per SSE connection

# Graceful Shutdown
SHUTDOWN_TIMEOUT=30000            # Max wait time for shutdown in ms (30 seconds)
